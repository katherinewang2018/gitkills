## 比特币的数字签名是什么？
比特币的数字签名，就是只有比特币转账的转出方生成的，一段防伪造的字符串。

## 数字签名的用处？
用处就是通过验证该数字串：

一方面证明该交易是转出方发起的。

另一方面证明交易信息在传输中没有被更改。

数字签名通过数字摘要技术把交易信息缩短成固定长度的字符串

同时，数字签名加密的私钥和解密的公钥不一致，采用非对称加密技术。
 

### 什么是“扣款索偿”呢？
PayPal是如此定义的：“当买家要求其信用卡公司撤销一笔已经得到批准的交易时，就会发生扣款索偿。”

这样的机制，的确是在一定程度上，保护了买家的利益（？？）。但是，对于诚实的商户而言，是很不利的。根据2013年律商联讯（Lexis/Nexis）发布的报告，他们发现，线上商户需要为每一美元的，发生在互联网上的欺诈损失，支付3.1美元（也就是说，除了支付欺诈索偿费用、欺诈监控成本、以及银行收费，商户们还得承担商品的损失）。

接受信用卡付款的卖家要承担收到扣款索偿的风险，所以大多数卖家，都将潜在的扣款索偿损失，计算在交易成本中。

诚实的商户们，将会很乐意接受比特币这样的支付方式。可是，这对于诚实的顾客而言，似乎又带来了些许的麻烦，因为直接发送给卖家的币，是不可能被退回来了，除非卖家主动进行退币的操作。

### 传统的比特币交易流程

传统的比特币交易流程一般有如下两种形式：

买家直接转账给商家的比特币地址，这个时候发生纠纷，需要考验双方的人品（当然你也可以说大V的信誉比数学过硬，这是您的个人选择，当然你们也可以当面交易，然后坐等6个确认）。
一个中心化的托管服务，把交易的币打入中心化托管的账户，这个时候，本质上讲，这个中心托管的服务是完全拥有这笔比特币的所有权的，或者说，平台的私钥是可以控制这笔钱的。如果平台发生道德危机，或者黑客事件，交易资金的安全就得不到保证。（这也是交易平台让人担忧的原因，包括许多传统钱包，因为你的钱是被对方操控的，就算有100%保证金，也只是一种道德上的自我约束）
我们可以看到，以上两种形式，都不是那么的让人满意。但值得庆幸的是，比特币强大的脚本（script）语言，使得我们可以实现更棒的交易机制。

### 多重签名（Multisig）技术与P2SH协议

比特币网络的脚本语言，虽然不是图灵完全的，但是依然提供了应用开发的便利，这正是比特币强大的生命力所在，它本身是可以进化的，多重签名技术依托于BTC支持的P2SH（pay to script hash）协议，引入了比特币所有权的M of N （M≤N）判断机制， 也就是说生成多重签名地址需要N把公钥的参与。

币须网引入的多重签名交易流程中，买家，卖家，平台各持有一份私钥以及对应的公钥，利用2 of 3 的多重签名方式，做到更加安全，更易用，以及保护消费者利益的电商平台；这里需要说明的是，买家，卖家的私钥会在浏览器中通过用户自己的密码加密，也就是说币须网是永远无法获取用户私钥的。对于一笔交易，币须网会利用交易对应的买家，卖家，以及平台公钥生成一个唯一的多重签名支付地址（这个地址里的比特币，由与事三方共同管理）。

P2SH是MS多重签名的简化版本，如果使用P2SH进行和上方相同的2-3多重签名条件，步骤如下：

锁定脚本：
```
 <Public Key A> <Public Key B> <Public Key C> 3 OP_CHECKMULTISIG
```
对锁定脚本，首先采用SHA256哈希算法，随后对其运用RIPEMD160算法。20字节的脚本为：
```
8ac1d7a2fa204a16dc984fa81cfdf86a2a4e1731
```
于是锁定脚本变为：
```
OP_HASH160 8ac1d7a2fa204a16dc984fa81cfdf86a2a4e1731 OP_EQUAL
```

此锁定脚本要比原先使用MS的锁定脚本要简短的多，当接收方要使用此交易中的UTXO时，需要提交解锁脚本（这里又可称为赎回脚本）:
```
<Sig1> <Sig2> <2 PK1 PK2 PK3 PK4 PK5 5 OP_CHECKMULTISIG>
```
与锁定脚本相结合：
```
<Sig1> <Sig2> <2 PK1 PK2 PK3 PK4 PK5 5 OP_CHECKMULTISIG> OP_HASH160 8ac1d7a2fa204a16dc984fa81cfdf86a2a4e1731 OP_EQUAL
```
使用逆波兰表达式运算，就能很明显的得知，验证过程分两步，首先验证的是接收方附上的赎回脚本是否符合发送方的锁定脚本，如果是，便执行该脚本，进行多重签名的验证。
P2SH的特点是，将制作脚本的责任给了接收方，好处是可以暂缓节点存储的压力。





### 引入多重签名技术之后的退款流程
1.正常的退款流程。 买家申请退款，输入退款地址 浏览器中运行的代码会对从交易Multisig地址到退款地址的这笔transaction，利用买家的私钥进行签名。卖家同意退款，浏览器中运行的代码会利用卖家的私钥，对这笔退款交易进行签名。这样三方中有两方签名成功，这笔交易可以广播到比特币网络，用户也会受到退款了。
2.纠纷的退款流程。 买家申请退款，商家不同意退款，这个时候币须网会利用双方提供的快递单等申述信息，进行仲裁，如果仲裁决定退款通过，会利用币须网的私钥签名，加上买家的签名，这样三方中有两方签名成功，这笔交易可以广播到比特币网络，用户也会受到退款了（当然有人要说，如果币须网要是联合买家怎么办？对，你的质疑是有道理的，但作为一个电商平台有没有必要与某一个用户联合起来作恶，仅仅因为获得这一笔报酬，如果是，那么币须网是不想混了；就算币须网想作恶，那也只是造成一个用户的损失，其它所有用户仍然是安全的；如果你要说，有的人就是想损人不利己，那我们也无话可说，技术已经解决了它能够解决的问题）。

### 多重签名技术所能带来的好处
1.安全的：因为Multisig技术的保证，交易资金是安全的，币须网无法挪用交易资金。 买家，卖家都可以透明的看到这笔交易资金的安全存储。
2.消费者利益保护的：传统的比特交易发生之后，商家马上能够动这笔钱，消费者是弱势的；而现在需要买家的明确同意，商家真正的获取到这笔比特币。这样能够有效保护消费者的利益。
3.易用的:通过技术的封装，大家感觉不到Multisig的复杂，使用体验上和传统的淘宝，ebay的交易体验类似。

### 多重签名工作原理与实际应用

多重签名托管工作原理如下。当Alice想要发送20元钱给Bob购买一个产品时，首先Alice挑选一个相互信任的仲裁员，我们叫他Martin，然后通过Alice，Bob，Martin三方多重签名来发送20元钱。Bob看到付款后，确认订单，邮寄商品。当Alice收到商品之后，她可以创建一个20元的多重签名给Bob，来完成这一笔转账。然后，Bob再对其进行签名，这样就完成了转账。另外，Bob可能会选择不发送产品，在这种情况下，他创建并签署20元的退款交易发送给Alice，让Alice可以签名并发布。那么，如果Bob声称已经发货，但是Alice拒绝付款呢？Alice和Bob就会联系Martin，让他来决定谁对谁错。Martin赞成哪一方，他就创建一笔给自己1元和对方19元的交易，并由对方提供签名，从而完成转账。

CryptoCorp的核心产品是多重签名交易钱包，很多人包括我一直在努力推进。多重签名钱包的工作方式很简单。它有三个私钥，一个是本地私钥，就和传统比特币钱包一样。第二个私钥建议用户安全地储存（比如保险箱）。第三个私钥保存在服务器上。

通常情况下，当你想动用你的资金时，你的钱包会签署一笔交易，然后发送到服务器。最简单的方法是，该服务器会要求你输入谷歌验证码或者手机短信，验证成功后，它会再次签名该交易并发送出去。

而CryptoCrop正在做的采取了这一理念，并完成了两个重大改进。首先，CryptoCrop推出了“分层确定性多重签名”技术，而不是三个确定性的私钥。这使得CryptoCorp可以在保护用户隐私的同时，仍然和以前一样完成多重签名。

其次，更重要的是，CryptoCorp不仅仅是双因子认证。每次CryptoCorp收到一个待处理的服务时，它会通过一个复杂的机器学习程序，来检验欺诈模型，考虑到金额，频率，历史，收件人的身份等等因素，进行交易风险评分。如果风险评分低，服务器直接通过。如果风险评分高，服务器可以要求谷歌验证或者邮件确认。在非常高风险的状况下，服务器会交给人工审核，甚至要求电话验证。

### 地址：以数字1开头
1DSrfJdB2AnWaFNgSbv3MZC2m74996JafV
### 私钥：
5J76sF8L5jTtzE96r66Sf8cka9y44wdpJjMwCxR3tzLh3ibVPxh

私钥运算可以产生公钥，公钥运算可以产生地址（又可成为Public Key Hash，公钥哈希），
并且其中的运算虽然开源但是都不可逆。

### 交易
简单地说，交易指把比特币从一个地址转到另一个地址。更准确地说，一笔“交易”指一个经过签名运算的，表达价值转移的数据结构。每一笔“交易”都经过比特币网络传输，由矿工节点收集并封包至区块中，永久保存在区块链某处。


### 交易标准
为了让所有节点都能识别交易，因此将交易信息标准化是必不可少的，比特币的区块链社区主要支持以下五种交易标准：P2PKH、P2PK、MS（限15个密钥）、P2SH和OP_Return。OP_Return将不会介绍，因为其存储的是信息（或者说只是字节），并非比特币货币。

### 比特币脚本语言：
可以理解为类HTML的语言，所有的节点都能理解，并且按照步骤进行编译。而在交易过程中，发送方会将自己的UTXO（字符串，在比特币区块链中能代表一定数额的比特币，使得比特币可以追踪）使用锁定脚本进行锁定，锁定在接收方的地址上（也就是表示只有证明自己是接收方，才能够使用）。接收方如果要使用，必须使用解锁脚本，证明自己是这个地址的主人，各个节点才认可这笔交易。

### Signature签名：

签名内容主要是此交易摘要（也就是交易信息的Hash）与私钥进行运算。验证的话，将签名与公钥进行运算，如果能正确的得到交易摘要，则成功。

签名一个比特币交易时，比特币钱包软件会新获取一个随机数k，同时用k来计算出一个r，然后用“私钥+k+r+交易hash”来计算出签名Sig，最后将“公钥+r+Sig”广播出去，交易就成功发布到比特币网络了。

### 签名的安全性，其实本质是私钥保管的安全性